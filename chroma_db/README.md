# 📁 chroma_db 目录说明

## 🎯 目录用途

`chroma_db/` 目录是系统的**向量数据库存储中心**，用于持久化存储所有上传文档经过嵌入模型转换后的向量数据。

## 📊 核心功能

### 1. 向量数据存储
- **自动生成**: 当用户首次上传文档时，系统会自动在此目录创建向量数据库文件
- **格式优化**: 存储优化后的向量格式，确保快速检索和查询
- **持久化**: 避免每次重启应用都需要重新处理文档

### 2. 文档智能管理
- **增量更新**: 支持新增文档的增量处理，不会影响已有向量数据
- **版本管理**: 维护文档处理的历史状态
- **缓存机制**: 加速重复查询的响应速度

## 🛠 使用说明

### 自动创建（推荐）
**无需手动操作** - 系统会在首次运行时自动创建并配置此目录：

```bash
# 首次运行应用后会自动生成
streamlit run main.py
```

运行后目录结构将自动生成：
```
chroma_db/
├── chroma.sqlite3           # 主数据库文件
├── index                    # 向量索引文件
├── index_metadata.json      # 索引元数据
└── ...                      # 其他辅助文件
```

### 手动管理（高级用户）
如果需要重置或管理向量数据库：

```bash
# 清空向量数据库（重新开始）
rm -rf chroma_db/

# 或者通过应用界面重置
# 在系统信息标签页点击"清空文档"按钮
```

## ⚠️ 注意事项

1. **不要手动修改文件**：目录内的文件由 ChromaDB 自动管理，手动修改可能导致数据损坏
2. **备份建议**：如果需要备份，建议备份整个 `chroma_db/` 目录
3. **存储空间**：向量数据可能占用较大空间，请确保有足够的磁盘容量
4. **版本兼容性**：不同版本的 ChromaDB 可能产生不兼容的文件格式

## 🔧 故障排除

### 常见问题处理

**Q: 向量数据库损坏怎么办？**
```bash
# 解决方案：删除并重新创建
rm -rf chroma_db/
# 重新运行应用并上传文档
```

**Q: 磁盘空间不足？**
```bash
# 查看目录大小
du -sh chroma_db/

# 如果过大，可以考虑清空或使用更小的chunk_size
```

**Q: 权限问题？**
```bash
# 确保有读写权限
chmod -R 755 chroma_db/
```

## 📈 性能优化提示

- 较大的文档集合会产生更大的向量数据库
- 调整 `config.py` 中的 `chunk_size` 可以影响数据库大小
- 定期清理不再需要的文档可以释放空间

## 🔄 与其他组件的关系

```mermaid
graph LR
    A[用户文档] --> B[文档处理器]
    B --> C[嵌入模型]
    C --> D[chroma_db/ 存储]
    D --> E[检索系统]
    E --> F[用户问答]
```

这个目录是连接文档处理与智能检索的核心桥梁，确保了系统的高效运行和数据的持久化存储。

---

**💡 提示**: 对于大多数用户，无需直接操作此目录，系统会自动完成所有管理工作。
